syntax = "proto3";

package v1;

option go_package = "cloupeer.io/cloupeer/api/proto/v1";

// HubService defines the RPC interface for the Cloupeer Hub.
service HubService {
  // SendCommand transmits a command from the Controller to the Hub.
  // The Hub is then responsible for forwarding this to the target vehicle (e.g. via MQTT).
  rpc SendCommand (SendCommandRequest) returns (SendCommandResponse) {}
}

// SendCommandRequest mirrors the VehicleCommand CRD spec.
message SendCommandRequest {
  // The unique identifier of the vehicle (usually the Vehicle CR name).
  string vehicle_id = 1;
  
  // The type of command (e.g., "OTA", "Reboot").
  string command_type = 2;
  
  // Optional parameters for the command.
  map<string, string> parameters = 3;
}

message SendCommandResponse {
  // Indicates if the Hub successfully accepted the command for delivery.
  bool accepted = 1;
  
  // Human-readable message, useful for debugging or status updates.
  string message = 2;
}

// AgentCommand defines the standard message format exchanged between Hub and Agent via MQTT.
message AgentCommand {
  // Unique identifier for the command trace.
  // Use json_name to ensure the JSON key is "commandID" (not commandId).
  string command_id = 1 [json_name = "commandID"];

  // Type of the command (e.g., "OTA", "Reboot").
  string command_type = 2 [json_name = "commandType"];

  // Parameters for the command execution.
  map<string, string> parameters = 3;

  // Timestamp when the command was issued (Unix timestamp).
  int64 timestamp = 4;
}
